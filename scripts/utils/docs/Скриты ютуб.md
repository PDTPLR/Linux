(Due to technical issues, the search service is temporarily unavailable.)

# Заметка по скриптам для работы с youtube-dl в Arch Linux

## 1. Скрипт `ytd_video` (Скачивание видео с метаданными и субтитрами)

**Код:**
```bash
youtube-dl --add-metadata --embed-subs -i -o '[%(uploader)s] %(title)s.%(ext)s' $1
```

**Как работает:**
1. `--add-metadata` - добавляет метаданные видео (название, автора, описание) в файл
2. `--embed-subs` - встраивает доступные субтитры прямо в видеофайл
3. `-i` - игнорирует ошибки при скачивании
4. `-o '[%(uploader)s] %(title)s.%(ext)s'` - задает шаблон имени файла:
   - `[Автор] Название.расширение`
5. `$1` - принимает URL видео как аргумент

**Особенности для Arch Linux:**
- Требует установки `ffmpeg` для обработки субтитров и метаданных:
  ```bash
  sudo pacman -S ffmpeg
  ```
- Рекомендуется обновленный `youtube-dl` или альтернатива `yt-dlp`

---

## 2. Скрипт `ytd_audio` (Скачивание аудио)

**Код:**
```bash
youtube-dl --add-metadata -i -o '%(title)s.%(ext)s' -x -f bestaudio/best $1
```

**Как работает:**
1. `-x` - извлекает аудиодорожку
2. `-f bestaudio/best` - выбирает лучший аудиоформат
3. `--add-metadata` - добавляет теги (исполнитель, название альбома и т.д.)
4. Результат сохраняется как `Название.расширение`

**Важно для Arch:**
- Для конвертации в MP3 требуется:
  ```bash
  sudo pacman -S ffmpeg lame
  ```
- По умолчанию сохраняет в оригинальном формате (чаще всего opus/webm)

---

## 3. Скрипт `ytd` (Универсальный инструмент)

**Код:**
```bash
#!/bin/env bash
set -e

if [[ $1 == "-h" || $1 == "--help" ]]; then
  # Вывод справки
elif [[ $1 == "--mp3" ]]; then
  youtube-dl -x --audio-format mp3 --prefer-ffmpeg "$2"
elif [[ "$1" == "--mp4" ]]; then
  youtube-dl -f "bestvideo[ext=mp4]+bestaudio[ext=m4a]/bestvideo+bestaudio" --merge-output-format mp4 "$2"
elif [[ "$1" == "-s" || "$1" == "--search" ]]; then
  youtube-dl "ytsearch1: $2"
fi
```

**Функционал:**
1. `--mp3`:
   - Конвертирует в MP3 с битрейтом 128k
   - `--prefer-ffmpeg` - гарантирует использование ffmpeg для конвертации

2. `--mp4`:
   - Скачивает лучшее видео (mp4) и аудио (m4a)
   - Сшивает их в один MP4-файл
   - Оптимальное качество для большинства случаев

3. `-s/--search`:
   - Ищет видео по запросу через `ytsearch1:`
   - Скачивает первый результат поиска

**Arch-специфика:**
- Для работы всех функций требуется:
  ```bash
  sudo pacman -S youtube-dl ffmpeg python-pip
  pip install --user mutagen # для метаданных в некоторых случаях
  ```
- При проблемах с MP3 установите дополнительные кодекки:
  ```bash
  sudo pacman -S lame
  ```

---

## Общие рекомендации:
1. Установка/обновление:
   ```bash
   sudo pacman -Syu youtube-dl ffmpeg
   ```

2. Примеры использования:
   ```bash
   ytd_video "https://youtube.com/..."
   ytd_audio "https://youtube.com/..."
   ytd --mp3 "https://youtube.com/..."
   ytd -s "arch linux tutorial"
   ```

3. Советы:
   - Для 4K/HDR видео используйте `yt-dlp` (более актуальный форк)
   - Всегда проверяйте легальность контента перед скачиванием
   - Используйте VPN при работе с ограниченным контентом

4. Решение проблем:
   - Ошибка формата: обновите youtube-dl через `sudo pacman -Syu`
   - Проблемы с субтитрами: проверьте локаль `export LC_ALL=C`
   - Медленное скачивание: добавьте `--limit-rate 500K`

