#!/bin/sh

# ---------------------------------------
# СЕКЦИЯ 1: ЗАПУСК ОСНОВНЫХ ПРОЦЕССОВ
# ---------------------------------------

# Запуск sxhkd, если он ещё не запущен (управление горячими клавишами)
pgrep -x sxhkd > /dev/null || sxhkd &

# Исправление для некоторых Java-приложений (закомментировано)
# wmname LG3D

# ---------------------------------------
# СЕКЦИЯ 2: НАСТРОЙКА МОНИТОРОВ И РАБОЧИХ СТОЛОВ
# ---------------------------------------

# Создаём 9 рабочих столов на основном мониторе
bspc monitor  -d 1 2 3 4 5 6 7 8 9
# Создаём 1 рабочий стол (7-й) на мониторе LVDS-1 (для мультимониторной настройки, пока не завершено)
# bspc monitor eDP-1 -d 7  # TODO: Настройка для нескольких мониторов

# Включение режима "фокус следует за указателем" (окно активируется при наведении курсора)
bspc config focus_follows_pointer true

# ---------------------------------------
# СЕКЦИЯ 3: НАСТРОЙКА ВНЕШНЕГО ВИДА ОКОН
# ---------------------------------------

# Настройка границ окон
# Цвет границы активного окна
bspc config focused_border_color "#7899FA"
# Цвет границы неактивного окна
bspc config normal_border_color "#1f222b"
# Ширина границы окна
bspc config border_width 5
# Отключение границ в режиме "monocle" (одно окно на весь экран)
bspc config borderless_monocle true

# Цвет границы активного окна (альтернативный вариант)
bspc config active_border_color "#bd93f9"
# Цвет обратной связи при предварительном выборе (preselect)
bspc config presel_feedback_color "#6272a4"

# Исправление курсора (установка стандартного курсора "left_ptr")
xsetroot -cursor_name left_ptr

# Настройка отступов между окнами
# Отключение отступов в режиме "monocle"
bspc config gapless_monocle false
# Размер отступов между окнами
bspc config window_gap 17

# ---------------------------------------
# СЕКЦИЯ 4: УПРАВЛЕНИЕ ОКНАМИ МЫШЬЮ/ТАЧПАДОМ
# ---------------------------------------

# Настройка управления плавающими окнами с помощью мыши/тачпада
# Модификатор для действий с мышью (mod4 — это Super/Windows клавиша)
bspc config pointer_modifier mod4
# Действие при зажатии левой кнопки (перемещение окна)
bspc config pointer_action1 move
# Действие при зажатии средней кнопки (изменение размера с помощью боковой стороны)
bspc config pointer_action2 resize_side
# Действие при зажатии правой кнопки (изменение размера с помощью угла)
bspc config pointer_action3 resize_corner

# Установка чувствительности перемещения и изменения размера (меньше = более плавное движение)
bspc config pointer_motion_interval 5
# Автоматическое переключение фокуса на окно при перемещении или изменении размера
bspc config pointer_follows_focus false
# Автоматически переводить окно в плавающий режим при перемещении или изменении размера
bspc config automatic_scheme longest_side
bspc config removal_adjustment true

# Дополнительные настройки для управления окнами
bspc config split_ratio 0.5
bspc config single_monocle true
bspc config borderless_monocle true
bspc config gapless_monocle false
bspc config paddingless_monocle true

# ---------------------------------------
# СЕКЦИЯ 5: ПРАВИЛА ДЛЯ ОКОН
# ---------------------------------------

# Правила для окон
# Окна программы feh (просмотр изображений) будут плавающими
bspc rule -a "*" border=on
# Окна Firefox (закомментировано, можно раскомментировать для настройки)
# bspc rule -a firefox state=floating
# bspc rule -a firefox desktop='^2' follow=on

# ---------------------------------------
# СЕКЦИЯ 6: ЗАПУСК СИСТЕМНЫХ РЕСУРСОВ
# ---------------------------------------

# Загрузка настроек Xresources (например, для настройки шрифтов и цветов)
xrdb merge ~/.Xresources

# ---------------------------------------
# СЕКЦИЯ 7: АВТОЗАПУСК СКРИПТОВ И ПРИЛОЖЕНИЙ
# ---------------------------------------

# Запуск скриптов для старта
# Скрипт для случайных обоев (или других инициализаций)
~/.config/bspwm/scripts/launch.sh &
# Запуск Polybar (панель задач)
~/.config/polybar/launch.sh

# Запуск уведомлений (dunst) с пользовательской конфигурацией
dunst -config $HOME/.config/bspwm/dunstrc &

# Запуск утилит для батареи и подсветки
# Запуск скрипта для отслеживания заряда батареи
pkill battery-alert; ~/bin/battery-alert &
# Запуск redshift (автоматическая настройка цветовой температуры экрана)
pgrep -x redshift > /dev/null || redshift &

# Запуск композитоpa (закомментировано, можно добавить, например, picom)
picom &

# Автозапуск программ
# Запуск flameshot (для скриншотов)
flameshot &

# Запуск жестов для тачпада (libinput-gestures)
libinput-gestures &

#Запуск графических приложений которые просят права sudo
/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &
